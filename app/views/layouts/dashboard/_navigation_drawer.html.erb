<div class="navigation-drawer">
  <div class="">
    <a href="#" class="inline-flex items-center p-2 gap-2">
      <img src="<%= asset_path "icon.svg" %>" alt="logo" class="size-10">
      <div class="text-lg font-bold text-on-surface-variant">
        <%= t "general.dashboard" %>
      </div>
    </a>
  </div>

  <div class="flex items-center gap-2">
    <div class="menu">
      <label tabindex="0" class="button button--outlined">
        <img src="<%= avatar_url(@account.owner) %>" alt="avatar" class="w-6 h-6 rounded-full">
        <div>
          <%= @account.owner.name %>
        </div>
        <x-icon>arrow_drop_down</x-icon>
      </label>
      <div tabindex="0" class="menu__content top-full left-0">
        <div class="px-4 py-2 text-sm font-medium text-on-surface-variant">
          <%= t "general.personal" %>
        </div>

        <a href="<%= dashboard_root_path(Current.user.account.name) %>" class="menu__item">
          <img src="<%= avatar_url(Current.user) %>" alt="avatar" class="w-6 h-6 rounded-full">
          <div class="">
            <div class="font-medium">
              <%= Current.user.name %>
            </div>
          </div>
        </a>

        <hr class="border-outline-variant my-2">

        <div class="px-4 py-2 text-sm font-medium text-on-surface-variant">
          <%= t "general.organizations" %>
        </div>

        <% Current.user.organizations.includes(:account).each do |organization| %>
          <a href="<%= dashboard_root_path(organization.account.name) %>" class="menu__item">
            <img src="<%= avatar_url(organization) %>" alt="avatar" class="w-6 h-6 rounded-full">
            <div class="flex-grow">
              <div class="font-medium">
                <%= organization.name %>
              </div>
            </div>
          </a>
        <% end %>

        <a href="<%= new_organization_path %>" class="menu__item">
          <x-icon>add</x-icon>
          <span><%= t "general.new_organization" %></span>
        </a>
      </div>
    </div>
  </div>

  <div class="flex flex-col gap-2 grow">
    <a href="#" class="navigation-drawer__item">
      <div class="navigation-drawer__item__icon">
        <x-icon>dashboard</x-icon>
      </div>
      <div class="navigation-drawer__item__label">
        <%= t "general.overview" %>
      </div>
    </a>
    <a href="<%= dashboard_posts_path %>" class="navigation-drawer__item <%= "navigation-drawer__item--active" if current_page?(dashboard_posts_path) %>">
      <div class="navigation-drawer__item__icon">
        <x-icon>article</x-icon>
      </div>
      <div class="navigation-drawer__item__label">
        <%= t "general.posts" %>
      </div>
    </a>

    <a href="<%= dashboard_settings_profile_path %>" class="navigation-drawer__item <%= "navigation-drawer__item--active" if current_page?(dashboard_settings_profile_path) %>">
      <div class="navigation-drawer__item__icon">
        <x-icon>settings</x-icon>
      </div>
      <div class="navigation-drawer__item__label">
        <%= t "general.settings" %>
      </div>
    </a>
  </div>

  <% if Current.user %>
    <div class="menu flex-shrink-0">
      <label tabindex="0" class="navigation-drawer__item">
        <div class="navigation-drawer__item__icon">
          <img src="<%= avatar_url(Current.user) %>" class="h-6 w-6 rounded-full">
        </div>
        <div class="navigation-drawer__item__label">
          <%= Current.user.name %>
        </div>
      </label>
      <div tabindex="0" class="menu__content left-0 bottom-full right-0 w-full">
        <a href="<%= account_root_path(Current.user.account.name) %>" class="menu__item">
          <x-icon>account_circle</x-icon>
          <span><%= t "general.profile" %></span>
        </a>

        <a href="<%= bookmarks_path %>" class="menu__item">
          <x-icon>bookmarks</x-icon>
          <span><%= t "general.bookmarks" %></span>
        </a>

        <a href="<%= settings_root_path %>" class="menu__item">
          <x-icon>settings</x-icon>
          <span><%= t "general.settings" %></span>
        </a>

        <%= form_with url: sign_out_path, method: :delete do |form| %>
          <button type="submit" class="menu__item">
            <x-icon>logout</x-icon>
            <span><%= t "general.sign_out" %></span>
          </button>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
