<div class="container mx-auto p-4">
  <turbo-frame id="home_sidebar">
    <div class="space-y-4">
      <%= raw @site.sidebar_header_html %>

      <% if Current.user && !Current.user.email_verified? %>
        <div class="card bg-warning text-warning-content p-4">
          <h3 class="font-medium">
            <%= t '.email_is_not_verified' %>
          </h3>
          <div class="mt-4">
            <a href="<%= settings_email_path %>" class="btn">
              <%= t '.verify_email' %>
            </a>
          </div>
        </div>
      <% end %>

      <%
        popular_tags = Tag.order(taggings_count: :desc).limit(10)
      %>
      <div class="card card-default">
        <div class="card-body">
          <h3 class="card-title">
            <%= t "general.popular_tags" %>
          </h3>

          <div class="flex gap-2 flex-wrap mt-4">
            <% popular_tags.each do |tag| %>
              <a href="<%= tag_path(tag.name) %>" class="btn btn-soft btn-sm">
                #<%= tag.name %>
              </a>
            <% end %>
          </div>
        </div>
      </div>

      <%
        recommend_accounts = Account.where(id: Account.order(followers_count: :desc).excluding(Current.user&.account).limit(100)).order("RANDOM()").limit(3)
      %>
      <div class="card card-default">
        <div class="card-body">
          <div class="card-title">
            <%= t "general.recommend_users" %>
          </div>
          <div class="list mt-4 -mx-4">
            <%= render partial: "account/item", collection: recommend_accounts, as: :account %>
          </div>
        </div>
      </div>

      <div class="card card-default">
        <div class="card-body">
          <div class="card-title">
            <%= t "general.community_stats" %>
          </div>
          <div class="mt-4 space-y-4">
            <div class="flex items-center gap-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-icon lucide-user"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
              <div>
                <%= t "general.users_count", count: User.count %>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text-icon lucide-file-text"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>
              <div>
                <%= t "general.posts_count", count: Post.count %>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle-icon lucide-message-circle"><path d="M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719"/></svg>
              <div>
                <%= t "general.comments_count", count: Comment.count %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <%= raw @site.sidebar_footer_html %>
    </div>
  </turbo-frame>
</div>
