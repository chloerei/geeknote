<% @page_title = "#{@collection.name} - #{@account.display_name}" %>

<div class="container padding-3">
  <div class="breadcrumb margin-bottom-3">
    <div class="breadcrumb__item">
      <a href="<%= account_root_path(@account) %>">
        <div class="display-flex gap-2 align-items-center">
          <div class="avatar">
            <%= avatar_image_tag @account.owner.avatar %>
          </div>
          <div class="">
            <b><%= @account.owner.name %></b>
          </div>
        </div>
      </a>
    </div>

    <div class="breadcrumb__item">
      <a href="<%= account_collections_path(@account) %>">
        collection
      </a>
    </div>
  </div>

  <div class="margin-bottom-3">
    <div class="title-large margin-bottom-3">
      <%= @collection.name %>
    </div>

    <div class="text-muted margin-bottom-3">
      <%= @collection.description %>
    </div>

    <div class="text-muted display-flex gap-3 align-items-center">
      <div class="">
        <%= @collection.collection_items_count %> <%= t 'common.posts' %>
      </div>
      <% if @collection.visibility_private? %>
        <div class="display-flex align-items-center">
          <span class="material-icons material-icons--inline">lock</span>
          <%= t 'common.private' %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="layout-primary">
    <div class="">

      <div id="posts" class="display-flex flex-direction-column gap-3">
        <%= render partial: 'account/posts/post', collection: @pagination[:page].pluck(:data).map(&:post), cached: -> post { [post.account, post.user, post] } %>

        <% if @pagination[:page_info][:has_next_page] %>
          <a href="<%= url_for(after: @pagination[:page_info][:end_cursor]) %>" class="button button--text width-100 justify-content-center" id="posts__load-more" data-turbo-stream="true">
            Load more
          </a>
        <% else %>
          <div class="body-medium text-muted text-align-center padding-x-3 padding-y-2">
            No more content.
          </div>
        <% end %>
      </div>

    </div>
  </div>
</div>
