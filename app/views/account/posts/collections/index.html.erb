<div class="container container--small">
  <%= turbo_frame_tag "post-#{@post.id}-collections" do %>
    <div class="toolbar border-bottom">
      <div class="toolbar__title">
        <%= t 'common.add_to_collection' %>
      </div>
      <% if current_user.manage_accounts.any? %>
        <div class="toolbar__action">
          <div class="dropdown" data-controller="dropdown">
            <button type="button" class="button button--text" data-action="dropdown#toggle">
              <div class="button__text">
                <%= @collection_account.display_name %>
              </div>
              <div class="button__icon">
                <span class="material-icons">expand_more</span>
              </div>
            </button>
            <div class="dropdown__menu dropdown__menu--top-right">
              <%= button_to switch_account_post_collections_path(@account, @post, account: nil), method: 'put', class: 'dropdown__item' do %>
                <%= current_user.account.display_name %>
              <% end %>
              <% current_user.manage_accounts.each do |account| %>
                <%= button_to switch_account_post_collections_path(@account, @post, account: account.name), method: 'put', class: 'dropdown__item' do %>
                  <%= account.display_name %>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
      <div class="toolbar__action">
        <button type="button" class="button button--icon" data-action="dialog#close">
          <span class="material-icons">close</span>
        </button>
      </div>
    </div>

    <div class="overflow-auto">
      <% if @collections.any? %>
        <div class="list">
          <% @collections.each do |collection| %>
            <label class="list__item flex-align-items-center">
              <div class="list__check">
                <%= form_with model: collection, url: account_post_collection_path(@account, @post, collection), builder: CustomFormBuilder, class: 'form', data: { controller: 'form', action: 'change->form#submit' } do |form| %>
                  <%= form.check_box :added %>
                <% end %>
              </div>
              <div class="list__content">
                <%= collection.name %>
              </div>
              <div class="list__icon">
                <% case collection.visibility when 'private' %>
                  <span class="material-icons">lock</span>
                <% when 'public' %>
                  <span class="material-icons">public</span>
                <% end %>
              </div>
            </label>
          <% end %>
        </div>
      <% else %>
        <div class="content-placeholder">
          <div class="content-placeholder__icon">
            <span class="material-icons">library_books</span>
          </div>
          <div class="content-placeholder__label">
            <%= t 'common.no_collections_info' %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="toolbar border-top">
      <div class="toolbar__space">
      </div>
      <div class="toolbar__action">
        <a href="<%= new_account_post_collection_path(@account, @post) %>" class="button button--text button--primary">
          <div class="button__icon">
            <span class="material-icons">add</span>
          </div>
          <div class="button__text">
            <%= t 'common.new_collection' %>
          </div>
        </a>
      </div>
    </div>
  <% end %>
</div>
