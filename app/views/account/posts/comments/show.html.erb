<div class="container">
  <div class="layout">
    <div class="main">
      <div class="card card--surface padding-3 margin-bottom-3">
        <div class="breadcrumb">
          <div class="breadcrumb__item">
            <a href="<%= account_post_path(@account, @post) %>">
              <%= @post.title %>
            </a>
          </div>
          <div class="breadcrumb__item">
            <a href="<%= account_post_comments_path(@account, @post) %>">
              <%= t 'common.comments' %>
            </a>
          </div>
          <div class="breadcrumb__item breadcrumb__item--active">
            <%= @comment.id %>
          </div>
        </div>
      </div>

      <div class="margin-bottom-3">
        <%= render partial: 'comment', object: @comment %>
      </div>

      <div id="comments" class="display-flex flex-direction-column gap-3 comment-replies margin-bottom-3" data-liked-ids="<%= "[#{@replies.filter(&:liked).map(&:id).join(',')}]" %>">
        <div class="show-on-empty padding-3 text-muted text-align-center">
          <%= t 'common.no_replies_yet' %>
        </div>
        <%= render partial: 'comment', collection: @replies, cached: true %>
      </div>

      <div class="margin-3">
        <%= paginate @replies %>
      </div>

      <% if @post.allow_comments? %>
        <div id="reply">
          <% if current_user %>
            <%= render 'form', comment: @comment.replies.new %>
          <% else %>
            <a href="<%= sign_in_path(return_to: url_for()) %>" class="button button--filled">
              <%= t 'common.sign_in_to_comment' %>
            </a>
          <% end %>
        </div>
      <% else %>
        <div class="padding-3 text-muted text-align-center">
          <%= t 'common.comment_is_disabled' %>
        </div>
      <% end %>
    </div>
  </div>

</div>
