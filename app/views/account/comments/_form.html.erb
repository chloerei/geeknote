<%# locals: (comment:, open: false) %>

<details id="<%= dom_id(comment, :form) %>" class="group comment-form mt-4" <%= 'open' if open %> data-controller="comment-form" data-action="toggle->comment-form#focus" data-comment-form-markdown-field-outlet=".markdown-field">
  <summary class="block group-open:hidden">
    <div class="flex items-center h-12 px-4 text-sm text-base-content/80 font-medium rounded-full select-none bg-base-200 hover:bg-base-300 cursor-pointer">
      <%= t "general.add_comment" %>
    </div>
  </summary>

  <%= form_with model: comment, url: comment.new_record? ? account_comments_path(comment.user.account.name) : account_comment_path(comment.user.account.name, comment) do |form| %>
    <%= form.hidden_field :commentable_sgid, value: comment.commentable.to_sgid(for: :commentable) %>
    <%= form.hidden_field :parent_id %>
    <div class="">
      <%= render "components/markdown_field", form: form, name: :content, autofocus: open, options: { placeholder: "Markdown..." } %>
    </div>
    <div class="mt-4">
      <button type="submit" class="btn btn-primary">
        <%= t "general.reply" %>
      </button>
    </div>
  <% end %>
</details>
