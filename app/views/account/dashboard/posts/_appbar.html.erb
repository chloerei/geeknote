<div class="top-app-bar" id="appbar">
  <div class="top-app-bar__action">
    <a href="<%= account_dashboard_posts_path %>" class="button button--text button--muted">
      <div class="button__icon">
        <span class="material-icons">arrow_back_ios</span>
      </div>
      <div class="button__label">
        <%= t 'common.posts' %>
      </div>
    </a>
  </div>
  <div class="top-app-bar__title">
    <div class="body-medium text-muted padding-y-1">
      <span data-post-editor-target="saveStatus" data-message-saved='<%= t 'common.saved' %>' data-message-saving="<%= t 'common.saving' %>" data-message-save-failed="<%= t 'common.save_failed' %>"><%= Post.human_attribute_name("status.#{@post.status}") %></span>
    </div>
  </div>
  <div class="top-app-bar__action">
    <button type="button" class="button button--icon" data-action="post-editor#selectImage">
      <span class="material-icons">add_photo_alternate</span>
    </button>
  </div>
  <div class="toolbar__divider">
  </div>
  <% if @post.new_record? %>
    <div class="top-app-bar__action">
      <button type="button" class="button button--text" disabled>
        <%= t 'common.preview' %>
      </button>
    </div>
    <div class="top-app-bar__action">
      <button type="button" class="button button--text" disabled>
        <%= t 'common.publish' %>
      </button>
    </div>
    <div class="top-app-bar__action">
      <button type="button" class="button button--icon" disabled>
        <span class="material-icons">more_vert</span>
      </button>
    </div>
  <% else %>
    <% if @post.trashed? %>
      <div class="top-app-bar__action">
        <%= form_with model: @post, url: restore_account_dashboard_post_path(@account, @post) do |form| %>
          <button type="submit" class="button button--text">
            <div class="button__icon">
              <span class="material-icons">restore</span>
            </div>
            <div class="button__label">
              <%= t 'common.restore' %>
            </div>
          </button>
        <% end %>
      </div>
      <div class="top-app-bar__action">
        <%= form_with model: @post, url: account_dashboard_post_path(@account, @post), method: 'delete' do |form| %>
          <button type="submit" class="button button--text" data-confirm="Are you sure delete permanently?">
            <div class="button__icon">
              <span class="material-icons">delete_forever</span>
            </div>
            <div class="button__label">
              <%= t 'common.delete_permanently' %>
            </div>
          </button>
        <% end %>
      </div>
    <% else %>
      <div class="top-app-bar__action">
        <button type="submit" class="button button--text button--muted" name="submit" value="preview" form="post-form">
          <%= t 'common.preview' %>
        </button>
      </div>
      <div class="top-app-bar__action">
        <%= render 'publish_button' %>
      </div>
    <% end %>

    <div class="top-app-bar__action">
      <div class="dropdown" data-controller="dropdown">
        <button type="button" class="button button--icon" data-action="dropdown#toggle">
          <span class="material-icons">more_vert</span>
        </button>
        <div class="dropdown__container dropdown__container--top-right">
          <% if @post.published? %>
            <a href="<%= account_post_path(@account, @post) %>" class="dropdown__item">
              <div class="dropdown__item__icon">
                <span class="material-icons">preview</span>
              </div>
              <div class="dropdown__item__text">
                <%= t 'common.view' %>
              </div>
            </a>
            <%= form_with url: unpublish_account_dashboard_post_path(@account, @post), method: 'patch' do |form| %>
              <button type="submit" class="dropdown__item">
                <div class="dropdown__item__icon">
                  <span class="material-icons">unpublished</span>
                </div>
                <div class="dropdown__item__text">
                  <%= t 'common.unpublish' %>
                </div>
              </button>
            <% end %>
          <% end %>
          <a href="<%= account_dashboard_post_revisions_path(@account, @post) %>" class="dropdown__item">
            <div class="dropdown__item__icon">
              <span class="material-icons">history</span>
            </div>
            <div class="dropdown__item__text">
              <%= t 'common.history_revisions' %>
            </div>
          </a>
          <a href="<%= account_dashboard_post_settings_path(@account, @post) %>" class="dropdown__item">
            <div class="dropdown__item__icon">
              <span class="material-icons">settings</span>
            </div>
            <div class="dropdown__item__text">
              <%= t 'common.settings' %>
            </div>
          </a>
          <% if !@post.trashed? %>
            <hr class="divider">
            <%= form_with url: trash_account_dashboard_post_path(@account, @post), method: 'patch' do |form| %>
              <button type="submit" class="dropdown__item">
                <div class="dropdown__item__icon">
                  <span class="material-icons">delete</span>
                </div>
                <div class="dropdown__item__text">
                  <%= t 'common.move_to_trash' %>
                </div>
              </button>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
